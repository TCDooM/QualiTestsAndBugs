spec_version: 1

kind: blueprint
environmentType: sandbox

metadata:
  description:
    blueprint with aws marketplace app

clouds:
  - AWS: eu-west-1

inputs:
  - DB_USER: root  # Used to define the db admin account
  - DB_PASS:
      display_style: masked
      description: please set the root database password
      default_value: Colony!123
  # Used to define the db admin password
  - DB_NAME: demo_db  # DB_NAME - a target database name
  - TEXT:
      default_value: default_text
      display_style: masked 
      description: M r and Mrs Dursley, of number four, Privet Drive, were proud to say that they were perfectly normal, thank you very much. They were the last people you’d expect to be involved in anything strange or mysterious, because they just didn’t hold with such nonsense. Mr Dursley was the director of a fi rm called Grunnings,  Drive, were proud to say that they were perfectly normal, thank you very much. They were the last people you’d expect to be involved in anything strange or mysterious, because they just didn’t hold with such nonsense. Mr Dursley was the director of a fi rm called Grunnings,  Drive, were proud to say that they were perfectly normal, thank you very much. They were the last people you’d expect to be involved in anything strange or mysterious, because they just didn’t hold with such nonsense. Mr Dursley was the director of a fi rm called Grunnings,  Drive, were proud to say that they were perfectly normal, thank you very much. They were the last people you’d expect to be involved in anything strange or mysterious, because they just didn’t hold with such nonsense. Mr Dursley was the director of a fi rm called Grunnings,  Drive, were proud to say that they were perfectly normal, thank you very much. They were the last people you’d expect to be involved in anything strange or mysterious, because they just didn’t hold with such nonsense. Mr Dursley was the director of a fi rm called Grunnings,  Drive, were proud to say that they were perfectly normal, thank you very much. They were the last people you’d expect to be involved in anything strange or mysterious, because they just didn’t hold with such nonsense. Mr Dursley was the director of a fi rm called Grunnings,
      optional: true 
  - PORT: 3000
  - API_PORT: 3001
  - AWS_INSTANCE_TYPE: t2.large
  - RandomInput: blalblalba

applications:
  - Amir-mongodb:
      target: Amir-VM
      input_values:
        - AWS_INSTANCE_TYPE: t2.small
        - TEXT: $TEXT
        # - TEXT: blabla
        # - SANDBOX: $colony.environment.id 
        # - VNET: $colony.environment.virtual_network_id
        # - TEST: $colony.services.Amir-sleep.outputs.hostname
      depends_on:
        - Amir-sleep

#       input_values:
#         - DB_USER: $DB_USER
#         - DB_PASS: $DB_PASS
#         - DB_NAME: $DB_NAME
#         - DB_HOSTNAME: $outputs.rds-mysql-instance.hostname #DNS name output from the RDS service
#       depends_on:
#         - rds-mysql-instance

services:
  - Amir-sleep:
      outputs:
        - hostname
      input_values:
        - DURATION: 1
  # - sleep:
  #     input_values:
  #       - DURATION: 2
  #     outputs:        # Declaring the outputs from Terraform that will be recognized in this blueprint
  #       - hostname: "amir"    # The RDS host name will be used as an input to the application consuming the RDS service
  # - Amir-sleep:  # One instance of mysql (see: services/rds-mysql-aurora-cluster/rds-mysql-aurora-cluster.yaml)
  #     input_values:
  #       - DB_NAME: $DB_NAME
  #       - DB_USER: $DB_USER
  #       - DB_PASS: $DB_PASS
  #       - SANDBOX_ID: $colony.environment.id 
  #       - VPC_ID: $colony.environment.virtual_network_id #Sandbox VPC Id

debugging:
  availability: on
